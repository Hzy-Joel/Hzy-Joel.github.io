---
layout:     post
title:      "Transform使用"
subtitle:   "Transform使用"
date:       2020-07-19 15:40:00
author:     "hzy"
//header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - AOP
---


## Transform使用开发

 - build.gradle.kts导入相关依赖

   ```kotlin
   plugins {
       `kotlin-dsl`
   }
   repositories {
       jcenter()
       google()
   }
   
   dependencies{
       //自定义插件导入jar 自定义Plugin需要
       gradleApi()
       //自定义Transfrom工具包 自定义Transform需要
       implementation("com.android.tools.build:gradle:3.6.1")
   }
   ```

 -  自定义Transform类

   ```kotlin
   package com.hzy.buildsrc.ClickTrack
   
   import com.android.build.api.transform.QualifiedContent
   import com.android.build.api.transform.Transform
   import com.android.build.api.transform.TransformInvocation
   
   /**
    * User: hzy
    * Date: 2020/7/19
    * Time: 3:41 PM
    * Description: 自定义解析器 用于点击埋点
    */
   class ClickTransfrom: Transform(){
       override fun getName(): String {
           //
           TODO("Not yet implemented")
       }
   
       override fun getInputTypes(): MutableSet<QualifiedContent.ContentType> {
           TODO("Not yet implemented")
       }
   
       override fun isIncremental(): Boolean {
           TODO("Not yet implemented")
       }
   
       override fun getScopes(): MutableSet<in QualifiedContent.Scope> {
           TODO("Not yet implemented")
       }
   
       override fun transform(transformInvocation: TransformInvocation?) {
           super.transform(transformInvocation)
       }
   
   }
   ```

- 自定义Plugin类，添加

  ```kotlin
  package com.hzy.buildsrc
  
  import org.gradle.api.Plugin
  import org.gradle.api.Project
  
  /**
   * User: hzy
   * Date: 2020/7/15
   * Time: 12:23 PM
   * Description: 自定义Plugin
   */
  class ConsumePlugin : Plugin<Project> {
      override fun apply(pro: Project) {
          //注入自定义的
          pro.task("testTask").doLast {
              println("task Test....")
          }
  
      }
  }
  ```

- 根据处理流程处理输入文件

  ![Task函数中Map配置](https://hzy-joel.github.io/_post/AOP/transform.png)